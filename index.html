<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
  <title>Factura M√≥vil</title>
  <link rel="stylesheet" href="styles.css" />
  <!-- jsPDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" defer></script>
  <!-- Day.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.11.11/dayjs.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.11.11/locale/es.min.js" defer></script>
  <script src="app.js" defer></script>
</head>
<body>
  <header class="app-header">
    <div class="brand">
      <img id="brandLogo" src="assets/logo-placeholder.png" alt="logo" />
      <div>
        <h1 id="brandName">Mi Empresa</h1>
        <small id="brandEmail">correo@empresa.com</small>
      </div>
    </div>
    <button class="btn ghost" id="btnHomeTop">Inicio</button>
  </header>

  <main>
    <!-- Home -->
    <section id="view-home" class="view active">
      <h2>Panel principal</h2>
      <div class="cards">
        <button class="card" id="goNewInvoice">
          <span>‚ûï</span>
          <b>Nueva factura</b>
          <small>Crea y exporta con jsPDF</small>
        </button>
        <button class="card" id="goHistory">
          <span>üìú</span>
          <b>Historial</b>
          <small>Facturas guardadas</small>
        </button>
        <button class="card" id="goClients">
          <span>üë§</span>
          <b>Clientes</b>
          <small>Agenda r√°pida</small>
        </button>
        <button class="card" id="goConfig">
          <span>‚öôÔ∏è</span>
          <b>Configuraci√≥n</b>
          <small>Logo, datos y pagos</small>
        </button>
      </div>
    </section>

    <!-- Nueva factura -->
    <section id="view-invoice" class="view">
      <div class="toolbar">
        <button class="btn ghost backHome">&larr; Volver</button>
        <h2>Nueva factura</h2>
      </div>

      <form id="invoiceForm">
        <div class="row">
          <label>N√∫mero</label>
          <div class="row-inline">
            <input id="invPrefix" value="FAC-" class="sm"/>
            <input id="invNumber" type="number" min="1" value="1" class="sm"/>
          </div>
        </div>

        <div class="row">
          <label>Cliente</label>
          <div class="row-inline">
            <select id="clientSelect"></select>
            <button type="button" class="btn" id="addClientInline">+ Cliente</button>
          </div>
        </div>

        <div class="row two">
          <div>
            <label>Fecha</label>
            <input id="invDate" type="date" />
          </div>
          <div>
            <label>Vence</label>
            <input id="invDue" type="date" />
          </div>
        </div>

        <div class="row">
          <label>Conceptos</label>
          <table class="lines" id="linesTable">
            <thead>
              <tr><th>Descripci√≥n</th><th class="n">Cant.</th><th class="n">Precio</th><th class="n">Total</th><th></th></tr>
            </thead>
            <tbody id="linesBody"></tbody>
          </table>
          <button type="button" class="btn" id="addLine">+ L√≠nea</button>
        </div>

        <div class="row two">
          <div>
            <label>Descuento %</label>
            <input id="discPct" type="number" min="0" step="0.01" value="0"/>
          </div>
          <div>
            <label>Impuesto %</label>
            <input id="taxPct" type="number" min="0" step="0.01" value="11.5"/>
          </div>
        </div>

        <div class="totals">
          <div><span>Subtotal</span><b id="tSubtotal">$0.00</b></div>
          <div><span>Descuento</span><b id="tDiscount">$0.00</b></div>
          <div><span>Impuesto</span><b id="tTax">$0.00</b></div>
          <div class="total"><span>Total</span><b id="tTotal">$0.00</b></div>
        </div>

        <div class="row">
          <label>Enlace de pago (Stripe/PayPal)</label>
          <div class="row-inline">
            <input id="payLink" placeholder="Pega tu Payment Link o PayPal.me" />
            <button type="button" class="btn" id="btnPickPayLink">A√±adir enlace</button>
          </div>
          <small class="muted">
            Tip: administra tus enlaces guardados en <b>Configuraci√≥n &rarr; Enlaces de pago</b>.
          </small>
        </div>

        <div class="row">
          <label>Notas</label>
          <textarea id="invNotes" rows="3" placeholder="Gracias por su negocio."></textarea>
        </div>

        <div class="actions">
          <button type="button" class="btn primary" id="btnSave">Guardar</button>
          <button type="button" class="btn" id="btnPDF">Exportar PDF</button>
          <button type="button" class="btn ghost" id="btnClear">Limpiar</button>
        </div>
      </form>
    </section>

    <!-- Historial -->
    <section id="view-history" class="view">
      <div class="toolbar">
        <button class="btn ghost backHome">&larr; Volver</button>
        <h2>Historial</h2>
      </div>
      <div id="historyList" class="list"></div>
    </section>

    <!-- Clientes -->
    <section id="view-clients" class="view">
      <div class="toolbar">
        <button class="btn ghost backHome">&larr; Volver</button>
        <h2>Clientes</h2>
      </div>

      <form id="clientForm" class="panel">
        <div class="row two">
          <div>
            <label>Nombre</label>
            <input id="cName" required />
          </div>
          <div>
            <label>Email</label>
            <input id="cEmail" type="email"/>
          </div>
        </div>
        <div class="row two">
          <div>
            <label>Tel√©fono</label>
            <input id="cPhone" />
          </div>
          <div>
            <label>Direcci√≥n</label>
            <input id="cAddress" />
          </div>
        </div>
        <div class="row">
          <button type="button" class="btn primary" id="saveClient">Guardar cliente</button>
        </div>
      </form>

      <div id="clientsList" class="list"></div>
    </section>

    <!-- Configuraci√≥n -->
    <section id="view-config" class="view">
      <div class="toolbar">
        <button class="btn ghost backHome">&larr; Volver</button>
        <h2>Configuraci√≥n</h2>
      </div>

      <div class="panel">
        <div class="row">
          <label>Nombre comercial</label>
          <input id="cfgName" value="Mi Empresa"/>
        </div>
        <div class="row">
          <label>Email de contacto</label>
          <input id="cfgEmail" value="correo@empresa.com"/>
        </div>
        <div class="row">
          <label>Logo (PNG/JPG)</label>
          <input id="cfgLogo" type="file" accept="image/png,image/jpeg"/>
          <small class="muted">Se guarda localmente (localStorage).</small>
        </div>
      </div>

      <!-- Enlaces de pago -->
      <div class="panel">
        <h3 style="margin-top:0">Enlaces de pago</h3>
        <div class="row two">
          <div>
            <label>Nombre del enlace</label>
            <input id="plName" placeholder="Stripe Link / PayPal Link"/>
          </div>
          <div>
            <label>URL</label>
            <input id="plUrl" placeholder="https://..." />
          </div>
        </div>
        <div class="row">
          <button class="btn primary" id="addPayLink">Agregar enlace</button>
        </div>

        <div class="list" id="payLinksList"></div>
        <small class="muted">Marca uno como <b>Predeterminado</b> para auto-llenar al crear factura.</small>
      </div>
    </section>
  </main>

  <nav class="bottom-nav">
    <button data-target="view-home" class="active">üè†</button>
    <button data-target="view-invoice">üßæ</button>
    <button data-target="view-history">üìú</button>
    <button data-target="view-clients">üë§</button>
    <button data-target="view-config">‚öôÔ∏è</button>
  </nav>

  <!-- Modal selector de enlaces -->
  <div class="modal-backdrop" id="modalPL" style="display:none">
    <div class="modal">
      <h3>Selecciona un enlace de pago</h3>
      <div id="modalPLList" class="list" style="margin:10px 0 14px"></div>
      <div style="display:flex; gap:8px; justify-content:flex-end">
        <button class="btn ghost" id="modalPLClose">Cancelar</button>
      </div>
    </div>
  </div>
</body>
</html>
